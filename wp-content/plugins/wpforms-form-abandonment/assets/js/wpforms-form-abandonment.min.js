"use strict";var WPFormsFormAbandonment=window.WPFormsFormAbandonment||function(n,o,t){var a,i={},r=!1,e=!1,s={mobileDetect:null,init:function(){var e;"undefined"!=typeof MobileDetect&&(s.mobileDetect=new MobileDetect(o.navigator.userAgent)),t(n).on("input",".wpforms-form-abandonment :input",s.prepData),t(n).on("change",".wpforms-form-abandonment input[type=radio]",s.prepData),t(n).on("change",".wpforms-form-abandonment input[type=checkbox]",s.prepData),t(n).on("change",".wpforms-form-abandonment .wpforms-timepicker",s.prepData),t(n).on("mouseleave",this.abandonMouse),s.isMobileDevice()?(s.isIOSDevice()&&t("a").css("cursor","pointer"),e="ontouchstart"in o?"touchstart":"click",t(n).on(e,this.abandonClick)):t(n).on("mousedown",this.abandonClick),t(o).on("beforeunload",this.abandonBeforeUnload),t(".wpforms-form").on("wpformsAjaxSubmitSuccess",s.ajaxSubmitSuccess)},isMobileDevice:function(){return!!s.mobileDetect&&!!s.mobileDetect.mobile()},isIOSDevice:function(){return!!s.mobileDetect&&"iOS"===s.mobileDetect.os()},prepData:function(e){e=t(e.target).closest(".wpforms-form");a=e.data("formid"),i[a]=e.serializeArray(),r=JSON.stringify(i),s.debug("Preping data")},sendData:function(){r&&!e&&a&&void 0!==i[a]&&(e=!0,setTimeout(function(){e=!1},1e4),s.debug("Sending"),t.post(wpforms_form_abandonment.ajaxurl,{action:"wpforms_form_abandonment",forms:r}),r=!(i={}))},abandonMouse:function(e){e.offsetX<-1||20<e.clientY||(s.debug("Mouse abandoned"),s.sendData())},abandonClick:function(e){for(var n,o,t=e.srcElement||e.target;t&&(void 0===t.tagName||"a"!==t.tagName.toLowerCase()||!t.href);)t=t.parentNode;t&&t.href&&(s.debug("Click abandoned"),o=t.href,n="internal","mailto"===t.protocol?n="mailto":-1===o.indexOf(wpforms_form_abandonment.home_url)&&(n="external"),["external","internal"].indexOf(n)<0||o.match(/^javascript\:/i)||(o=!(!t.target||t.target.match(/^_(self|parent|top)$/i))&&t.target,(e.ctrlKey||e.shiftKey||e.metaKey||2===e.which)&&(o="_blank"),(o||s.isIOSDevice())&&s.sendData()))},abandonBeforeUnload:function(e){s.debug("Before unload abandoned"),s.sendData()},ajaxSubmitSuccess:function(){s.debug("Ajax submit success event");var e=t(this).data("formid");delete i[e],a=void 0,r=JSON.stringify(i)},debug:function(e){o.location.hash&&"#wpformsfadebug"===o.location.hash&&console.log("WPForms FA: "+e)}};return s}(document,window,jQuery);WPFormsFormAbandonment.init();