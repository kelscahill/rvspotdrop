"use strict";var WPFormsBuilderFormLocker=window.WPFormsBuilderFormLocker||function(e,r){var n={scheduling:{start:{$dpicker:r("#wpforms-panel-field-settings-form_locker_schedule_start_date"),$tpicker:r("#wpforms-panel-field-settings-form_locker_schedule_start_time")},end:{$dpicker:r("#wpforms-panel-field-settings-form_locker_schedule_end_date"),$tpicker:r("#wpforms-panel-field-settings-form_locker_schedule_end_time")}}},l={init:function(){r(e).ready(l.ready)},ready:function(){l.events(),l.conditionals(),l.dateTimePicker(),l.scheduleDatetimeEvents()},events:function(){r(".wpforms-panel-field-datetime .wpforms-clear-datetime-field").click(function(){var e=r(this).siblings("input");e.prop("_flatpickr")?e.prop("_flatpickr").clear():e.val(""),r(this).hide()})},conditionals:function(){if(void 0!==r.fn.conditions){r.each([{id:"#wpforms-panel-field-settings-form_locker_password_enable",hides:"#wpforms-panel-field-settings-form_locker_password-wrap,#wpforms-panel-field-settings-form_locker_password_message-wrap"},{id:"#wpforms-panel-field-settings-form_locker_schedule_enable",hides:"#wpforms-form-locker-schedule-datetime-block,#wpforms-panel-field-settings-form_locker_schedule_message-wrap"},{id:"#wpforms-panel-field-settings-form_locker_entry_limit_enable",hides:"#wpforms-panel-field-settings-form_locker_entry_limit-wrap,#wpforms-panel-field-settings-form_locker_entry_limit_message-wrap"},{id:"#wpforms-panel-field-settings-form_locker_user_enable",hides:"#wpforms-panel-field-settings-form_locker_user_message-wrap"}],function(e,t){r(t.id).conditions({conditions:{element:t.id,type:"checked",operator:"is"},actions:{if:{element:t.hides,action:"show"},else:{element:t.hides,action:"hide"}},effect:"appear"})})}},dateTimePicker:function(){l.datePicker(),l.timePicker(),l.datePair(),l.dateTimeClearBtnsInit()},datePicker:function(){void 0!==r.fn.flatpickr&&(r("#wpforms-panel-field-settings-form_locker_schedule_start_date").flatpickr(l.datePickerGetArgs("start")),r("#wpforms-panel-field-settings-form_locker_schedule_end_date").flatpickr(l.datePickerGetArgs("end")))},timePicker:function(){if(void 0!==r.fn.timepicker){var e={appendTo:r("#wpforms-builder"),disableTextInput:!0,timeFormat:wpforms_admin_builder_form_locker.time_format},t=r("#wpforms-panel-field-settings-form_locker_schedule_start_time"),i=r("#wpforms-panel-field-settings-form_locker_schedule_end_time");t.timepicker(e).on("selectTime",l.dateTimeClearBtnsRefresh),i.timepicker(e).on("selectTime",l.dateTimeClearBtnsRefresh)}},datePair:function(){var e={anchor:null,defaultDateDelta:0,defaultTimeDelta:18e5,dateClass:"wpforms-datepair-date",timeClass:"wpforms-datepair-time",startClass:"wpforms-datepair-start",endClass:"wpforms-datepair-end",parseDate:function(e){return r(e).prop("_flatpickr").selectedDates[0]},updateDate:function(e,t){var i=r(e);i.prop("_flatpickr").setDate(t),l.dateTimeClearBtnsRefresh(i),i.trigger("change")},updateTime:function(e,t){var i=r(e);i.timepicker("setTime",t),l.dateTimeClearBtnsRefresh(i),i.trigger("change")}};r("#wpforms-form-locker-schedule-datetime-block").datepair(e)},dateTimeClearBtnsInit:function(){r("#wpforms-form-locker-schedule-datetime-block .wpforms-clear-datetime-field").each(function(){var e=r(this);""===e.siblings('[id^="wpforms-panel-field-settings-form_locker_schedule_"]').val()&&e.hide()})},dateTimeClearBtnsRefresh:function(e){e.target&&(e=r(e.target)),e&&""!==e.val()&&e.nextAll("button.wpforms-clear-datetime-field").show()},datePickerGetArgs:function(i){i="start"===i?"start":"end";var r=n.scheduling[i].$tpicker,s=n.scheduling[i].$dpicker,e={altInput:!0,altFormat:wpforms_admin_builder_form_locker.date_format,dateFormat:"Y-m-d",onChange:function(e){var t={field:"start"===i?"end":"start"};t.$dpicker=n.scheduling[t.field].$dpicker,t.$tpicker=n.scheduling[t.field].$tpicker,""===r.val()&&""===t.$tpicker.val()&&r.timepicker("setTime",new Date(e)),l.dateTimeClearBtnsRefresh(r),l.dateTimeClearBtnsRefresh(s)}};return e},scheduleDatetimeEvents:function(){r("#wpforms-form-locker-schedule-datetime-block").on("change","input",function(e){var t=n.scheduling.start.$dpicker.val(),i=n.scheduling.start.$tpicker.val(),r=n.scheduling.end.$dpicker.val(),s=n.scheduling.end.$tpicker.val();if(""!==t&&""!==r&&!((t+i).replace(/\D/g,"")<(r+s).replace(/\D/g,""))){var a=new Date(t+" "+i);a.setMinutes(a.getMinutes()+30),n.scheduling.end.$tpicker.timepicker("setTime",a),n.scheduling.end.$dpicker.prop("_flatpickr").setDate(a),l.dateTimeClearBtnsRefresh(n.scheduling.end.$tpicker),l.dateTimeClearBtnsRefresh(n.scheduling.end.$dpicker)}})}};return l}(document,(window,jQuery));WPFormsBuilderFormLocker.init();