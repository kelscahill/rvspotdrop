"use strict";var WPFormsFormLocker=window.WPFormsFormLocker||function(e,l){var p={init:function(){l(e).ready(p.ready)},ready:function(){p.validation(),p.initNameGroupsValidation()},validation:function(){void 0!==l.fn.validate&&l.validator.addMethod("unique",function(n,o,e,d){if(this.optional(o))return"dependency-mismatch";d="string"==typeof d&&d||"unique";var u,a,t,i,s=l(o),m=s.closest(".wpforms-field"),f=this.previousValue(o,d);return a={action:"wpforms_form_locker_unique_answer",form_id:s.closest(".wpforms-form").data("formid"),field_id:m.data("field-id")},i=o.name,m.hasClass("wpforms-field-name")&&(n=p.getCombinedValue(m),i="wpforms[fields]["+a.field_id+"]"),a[i]=n,this.settings.messages[o.name]||(this.settings.messages[o.name]={}),f.originalMessage=f.originalMessage||this.settings.messages[o.name][d],this.settings.messages[o.name][d]=f.message,e="string"==typeof e&&{url:e}||e,t=l.param(l.extend({data:n},e.data)),f.old===t?f.valid:(f.old=t,(u=this).startRequest(o),l.ajax(l.extend(!0,{url:wpforms_form_locker.ajaxurl,type:"post",mode:"abort",port:"validate"+o.name,dataType:"json",data:a,context:u.currentForm,success:function(e){var a,t,i,s=!0===e||"true"===e,r=o.name.replace(/(\[[a-z]*\])$/g,"");u.settings.messages[o.name][d]=f.originalMessage,s?(i=u.formSubmitted,u.resetInternals(),u.toHide=u.errorsFor(o),u.formSubmitted=i,(u=p.updateValidatorLists(u,r,m,s)).showErrors()):(a={},t=e||u.defaultMessage(o,{method:d,parameters:n}),a[o.name]=f.message=t,(u=p.updateValidatorLists(u,r,m,s)).showErrors(a)),f.valid=s,u.stopRequest(o,s)}},e)),"pending")},wpforms_settings.val_unique)},initNameGroupsValidation:function(){l(".wpforms-validate").each(function(){var e=l(this),a=e.data("validator");l.extend(a.groups,p.getNameGroups(e))})},getCombinedValue:function(e){var a=[];return e.find("input[data-rule-unique]").each(function(){var e=l(this).val();wpforms.empty(e)||a.push(e)}),a.join(" ")},getNameGroups:function(e){var r={};return e.find(".wpforms-field.wpforms-field-name.wpforms-field-unique").each(function(e){var i=l(this),s=i.attr("id").replace("-container","")+"-field-group";l.each(["first","middle","last"],function(e,a){var t=i.find(".wpforms-field-name-"+a).attr("name")||!1;t&&(r[t]=s)})}),r},updateValidatorLists:function(t,i,s,r){return l.each(t.invalid,function(e){if(!(e.indexOf(i)<0)){t.invalid[e]=!r;var a=s.find('input[name="'+e+'"]');r&&t.successList.push(a[0])}}),t}};return p}(document,(window,jQuery));WPFormsFormLocker.init();